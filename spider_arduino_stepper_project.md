# 아두이노 스텝모터 거미 알림 장치 설계 (.md 정리)

퇴근/출근을 잊지 않도록, 정해진 시간대에 **줄에 매달린 거미**가
살아있는 것처럼 오르내리며 사람 눈에 띄게 만드는 프로젝트 정리본입니다.

- **컨트롤러**: Arduino Uno 또는 Nano
- **모터**: 28BYJ-48 스텝모터 + ULN2003 드라이버 보드
- **시간 관리**: DS3231 RTC 모듈
- **구현 기능**:
  - 아침: **09:20 ~ 09:40**
  - 저녁: **18:00 ~ 18:20**
  - 위 시간대에만 스텝모터가 랜덤 패턴으로 거미를 위/아래로 움직임
  - 한 번의 "세션" 동안 1~3개의 패턴이 연속 실행
  - 패턴 사이에는 진짜 거미처럼 일정 시간 정지 상태 유지
  - 시간대 밖에서는 거의 가만히 있고, 필요하면 서서히 위로 복귀

---

## 1. 전체 시스템 개념

1. 거미 인형을 얇은 실(낚싯줄, 테그줄 등)에 매달고,
2. 실의 윗쪽을 **릴(드럼)**에 감아서 28BYJ-48 스텝모터 축에 고정한다.
3. 스텝모터가 정방향/역방향으로 회전하면서 줄을 감고 풀어
   - 거미가 아래로 내려왔다가
   - 다시 위로 올라가게 만든다.
4. **DS3231 RTC 모듈**로 정확한 현재 시간을 읽어서
   - 오전 9:20~9:40
   - 오후 18:00~18:20
   에만 거미가 "살아있는 것처럼" 랜덤 패턴으로 움직인다.

릴의 반지름은 약 **1.5 ~ 2cm** 정도로 설정하고,
`maxDownSteps` 값(대략 2000~2200 스텝)을 조정하여
실제 거미가 약 **10cm 이상** 내려오도록 튜닝할 수 있다.

---

## 2. 회로 요약

### DS3231 ↔ Arduino

- VCC → 5V  
- GND → GND  
- SDA → A4  
- SCL → A5  

### 28BYJ-48 + ULN2003 ↔ Arduino

- IN1 → D8  
- IN2 → D9  
- IN3 → D10  
- IN4 → D11  
- VCC(+) → 5V  
- GND(–) → GND  

> RTC, ULN2003, Arduino **모두 GND 공통**이어야 함.

---

## 3. 시간대별 동작

- **아침**: 09:20 ~ 09:40  
- **저녁**: 18:00 ~ 18:20  

이 시간대에만 “살아있는 모드”로 동작:

- 세션 시작 시
  - 1~3개의 패턴을 랜덤으로 선택해 연속 실행
  - 패턴 사이마다 1~5초 정지
- 세션이 끝나면
  - 10~40초 아무 것도 안 하고 정지 → 이후 다시 새 세션 실행

비활성 시간대에는 거미가 서서히 위쪽으로 복귀하도록 `currentSteps`를 줄여준다.

---

## 4. 주요 코드 구조 개요

- `moveSpiderSteps(steps)`  
  - 스텝모터를 위/아래로 움직이며 `currentSteps`를 관리
- `isActiveTime(now)`  
  - 현재 시간이 아침/저녁 동작 시간대인지 판별
- 패턴 함수들
  - `patternSmallWiggle()` : 작은 진동
  - `patternDropAndSlightUp()` : 크게 떨어졌다 살짝 올라오기
  - `patternUpAndBack()` : 위로 갔다가 원위치
  - `patternSlowMove()` : 천천히 크게 이동
- `runRandomPattern()`  
  - 위 패턴 중 하나를 랜덤으로 실행
- `loop()`
  - 활성 시간대에는 세션 단위로 랜덤 패턴 실행
  - 비활성 시간대에는 천천히 위로 복귀

전체 사용 가능한 예제 코드는 `spider_controller/spider_controller.ino` 파일에 포함되어 있습니다.
